<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExcelAyuda - Tu solución en Excel</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.png" type="image/png" sizes="32x32">
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="logo.png" alt="Logo ExcelAyuda" class="logo">
            <h1>ExcelAyuda</h1>
        </div>
    </header>

    <main>
        <form id="excel-form" action="https://forms.gle/gFmkRG7aDQNCd4Uw7" method="POST" enctype="multipart/form-data" target="_blank">
            <p>Sube tu archivo y te ayudaremos de forma sencilla.</p>
            <!-- Correo se captura automáticamente, no lo incluimos -->

            <label for="file">Sube tu archivo Excel:</label>
            <input type="file" id="file" name="entry.1189489200" accept=".xls,.xlsx" required>

            <label for="difficulty">Nivel de dificultad:</label>
            <select id="difficulty" name="entry.319773037" required>
                <option value="">Selecciona una opción</option>
                <option value="Básico">Básico</option>
                <option value="Intermedio">Intermedio</option>
                <option value="Avanzado">Avanzado</option>
            </select>

            <label for="problem">Cuéntanos tu situación o problema:</label>
            <textarea id="problem" name="entry.1735911421" rows="4" placeholder="Describe aquí lo que necesitas resolver..." required></textarea>

            <input type="hidden" id="ticket" name="ticket">
            <button type="submit">Enviar solicitud</button>
        </form>

        <section id="ventajas">
            <h2>¿Por qué elegirnos?</h2>
            <ul>
                <li class="ventaja">Privacidad de los datos: Tus archivos y correos están seguros con nosotros.</li>
                <li class="ventaja">Equipo altamente profesional: Expertos en Excel listos para ayudarte.</li>
                <li class="ventaja">Solución garantizada: Resolvemos tus problemas, sin complicaciones.</li>
            </ul>
        </section>
    </main>

    <footer>
        <p>© 2025 ExcelAyuda. Todos los derechos reservados.</p>
        <p><a href="terminos.html">Términos y Condiciones</a></p>
    </footer>

    <script>
        document.getElementById("excel-form").addEventListener("submit", function(event) {
            // Generar número de ticket dinámico (ej. XXX.XXX)
            const ticketNumber = Math.floor(100000 + Math.random() * 900000);
            const ticketFormatted = `${Math.floor(ticketNumber / 1000)}.${ticketNumber % 1000}`;
            document.getElementById("ticket").value = ticketFormatted;

            // Mostrar alerta al usuario
            alert(`¡Solicitud enviada! Tu número de ticket es ${ticketFormatted}. Pronto te contactaremos.`);
        });

        window.addEventListener("scroll", function() {
            const ventajas = document.querySelectorAll(".ventaja");
            ventajas.forEach((ventaja) => {
                const position = ventaja.getBoundingClientRect().top;
                const screenPosition = window.innerHeight;
                if (position < screenPosition - 100) {
                    ventaja.classList.add("visible");
                }
            });
        });
    </script>
</body>
</html>
